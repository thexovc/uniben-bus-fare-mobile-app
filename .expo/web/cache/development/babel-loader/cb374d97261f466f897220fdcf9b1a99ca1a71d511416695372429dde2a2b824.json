{"ast":null,"code":"\"use strict\";\n\nvar _reactJsxRuntime = require(\"react/jsx-runtime\");\nvar _slicedToArray = require(\"@babel/runtime/helpers/slicedToArray\");\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  Object.defineProperty(o, k2, {\n    enumerable: true,\n    get: function get() {\n      return m[k];\n    }\n  });\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n  __setModuleDefault(result, mod);\n  return result;\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar React = __importStar(require(\"react\"));\nvar react_1 = require(\"react\");\nvar react_native_1 = require(\"react-native-web/dist/index\");\nvar react_native_webview_1 = require(\"react-native-webview\");\nvar helper_1 = require(\"./helper\");\nvar CLOSE_URL = 'https://standard.paystack.co/close';\nvar Paystack = function Paystack(_ref, ref) {\n  var paystackKey = _ref.paystackKey,\n    billingEmail = _ref.billingEmail,\n    phone = _ref.phone,\n    lastName = _ref.lastName,\n    firstName = _ref.firstName,\n    _ref$amount = _ref.amount,\n    amount = _ref$amount === void 0 ? '0.00' : _ref$amount,\n    _ref$currency = _ref.currency,\n    currency = _ref$currency === void 0 ? 'NGN' : _ref$currency,\n    _ref$channels = _ref.channels,\n    channels = _ref$channels === void 0 ? ['card'] : _ref$channels,\n    refNumber = _ref.refNumber,\n    billingName = _ref.billingName,\n    handleWebViewMessage = _ref.handleWebViewMessage,\n    onCancel = _ref.onCancel,\n    _ref$autoStart = _ref.autoStart,\n    autoStart = _ref$autoStart === void 0 ? false : _ref$autoStart,\n    onSuccess = _ref.onSuccess,\n    _ref$activityIndicato = _ref.activityIndicatorColor,\n    activityIndicatorColor = _ref$activityIndicato === void 0 ? 'green' : _ref$activityIndicato;\n  var _react_1$useState = react_1.useState(true),\n    _react_1$useState2 = _slicedToArray(_react_1$useState, 2),\n    isLoading = _react_1$useState2[0],\n    setisLoading = _react_1$useState2[1];\n  var _react_1$useState3 = react_1.useState(false),\n    _react_1$useState4 = _slicedToArray(_react_1$useState3, 2),\n    showModal = _react_1$useState4[0],\n    setshowModal = _react_1$useState4[1];\n  var webView = react_1.useRef(null);\n  react_1.useEffect(function () {\n    autoStartCheck();\n  }, []);\n  react_1.useImperativeHandle(ref, function () {\n    return {\n      startTransaction: function startTransaction() {\n        setshowModal(true);\n      },\n      endTransaction: function endTransaction() {\n        setshowModal(false);\n      }\n    };\n  });\n  var autoStartCheck = function autoStartCheck() {\n    if (autoStart) {\n      setshowModal(true);\n    }\n  };\n  var refNumberString = refNumber ? `ref: '${refNumber}',` : '';\n  var Paystackcontent = `   \n      <!DOCTYPE html>\n      <html lang=\"en\">\n        <head>\n          <meta charset=\"UTF-8\">\n          <meta http-equiv=\"X-UA-Compatible\" content=\"ie=edge\">\n          <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n          <title>Paystack</title>\n        </head>\n          <body  onload=\"payWithPaystack()\" style=\"background-color:#fff;height:100vh\">\n            <script src=\"https://js.paystack.co/v1/inline.js\"></script>\n            <script type=\"text/javascript\">\n              window.onload = payWithPaystack;\n              function payWithPaystack(){\n              var handler = PaystackPop.setup({ \n                key: '${paystackKey}',\n                email: '${billingEmail}',\n                firstname: '${firstName}',\n                lastname: '${lastName}',\n                phone: '${phone}',\n                amount: ${helper_1.getAmountValueInKobo(amount)}, \n                currency: '${currency}',\n                ${helper_1.getChannels(channels)}\n                ${refNumberString}\n                metadata: {\n                custom_fields: [\n                        {\n                        display_name:  '${firstName + ' ' + lastName}',\n                        variable_name:  '${billingName}',\n                        value:''\n                        }\n                ]},\n                callback: function(response){\n                      var resp = {event:'successful', transactionRef:response};\n                        window.ReactNativeWebView.postMessage(JSON.stringify(resp))\n                },\n                onClose: function(){\n                    var resp = {event:'cancelled'};\n                    window.ReactNativeWebView.postMessage(JSON.stringify(resp))\n                }\n                });\n                handler.openIframe();\n                }\n            </script> \n          </body>\n      </html> \n      `;\n  var messageReceived = function messageReceived(data) {\n    var webResponse = JSON.parse(data);\n    if (handleWebViewMessage) {\n      handleWebViewMessage(data);\n    }\n    switch (webResponse.event) {\n      case 'cancelled':\n        setshowModal(false);\n        onCancel({\n          status: 'cancelled'\n        });\n        break;\n      case 'successful':\n        setshowModal(false);\n        var reference = webResponse.transactionRef;\n        if (onSuccess) {\n          onSuccess({\n            status: 'success',\n            transactionRef: reference,\n            data: webResponse\n          });\n        }\n        break;\n      default:\n        if (handleWebViewMessage) {\n          handleWebViewMessage(data);\n        }\n        break;\n    }\n  };\n  var onNavigationStateChange = function onNavigationStateChange(state) {\n    var url = state.url;\n    if (url === CLOSE_URL) {\n      setshowModal(false);\n    }\n  };\n  return _reactJsxRuntime.jsx(react_native_1.Modal, {\n    style: {\n      flex: 1\n    },\n    visible: showModal,\n    animationType: \"slide\",\n    transparent: false,\n    children: _reactJsxRuntime.jsxs(react_native_1.SafeAreaView, {\n      style: {\n        flex: 1\n      },\n      children: [_reactJsxRuntime.jsx(react_native_webview_1.WebView, {\n        style: [{\n          flex: 1\n        }],\n        source: {\n          html: Paystackcontent\n        },\n        onMessage: function onMessage(e) {\n          var _e$nativeEvent;\n          messageReceived((_e$nativeEvent = e.nativeEvent) == null ? void 0 : _e$nativeEvent.data);\n        },\n        onLoadStart: function onLoadStart() {\n          return setisLoading(true);\n        },\n        onLoadEnd: function onLoadEnd() {\n          return setisLoading(false);\n        },\n        onNavigationStateChange: onNavigationStateChange,\n        ref: webView,\n        cacheEnabled: false,\n        cacheMode: 'LOAD_NO_CACHE'\n      }), isLoading && _reactJsxRuntime.jsx(react_native_1.View, {\n        children: _reactJsxRuntime.jsx(react_native_1.ActivityIndicator, {\n          size: \"large\",\n          color: activityIndicatorColor\n        })\n      })]\n    })\n  });\n};\nexports.default = react_1.forwardRef(Paystack);","map":{"version":3,"names":["React","__importStar","require","react_1","react_native_1","react_native_webview_1","helper_1","CLOSE_URL","Paystack","_ref","ref","paystackKey","billingEmail","phone","lastName","firstName","_ref$amount","amount","_ref$currency","currency","_ref$channels","channels","refNumber","billingName","handleWebViewMessage","onCancel","_ref$autoStart","autoStart","onSuccess","_ref$activityIndicato","activityIndicatorColor","_react_1$useState","useState","_react_1$useState2","_slicedToArray","isLoading","setisLoading","_react_1$useState3","_react_1$useState4","showModal","setshowModal","webView","useRef","useEffect","autoStartCheck","useImperativeHandle","startTransaction","endTransaction","refNumberString","Paystackcontent","getAmountValueInKobo","getChannels","messageReceived","data","webResponse","JSON","parse","event","status","reference","transactionRef","onNavigationStateChange","state","url","_reactJsxRuntime","jsx","Modal","style","flex","visible","animationType","transparent","children","jsxs","SafeAreaView","WebView","source","html","onMessage","e","_e$nativeEvent","nativeEvent","onLoadStart","onLoadEnd","cacheEnabled","cacheMode","View","ActivityIndicator","size","color","exports","default","forwardRef"],"sources":["../src/paystack.tsx"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}